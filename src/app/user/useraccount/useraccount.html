<div class="profile-container">
    <!-- LEFT COLUMN -->
    <div class="profile-column left-column">
        <!-- PERSONAL INFORMATION -->
        <div class="section-title">PERSONAL INFORMATION</div>
        <div class="profile-section">
            <div class="section-info">
                <div class="info-header" *ngIf="!editMode">
                    {{ user.title | uppercase }} {{ user.firstName | uppercase }} {{ user.lastName | uppercase }}
                </div>

            </div>

            <div *ngIf="!editMode" class="info-list">
                <div class="info-item">
                    <i class="fa-solid fa-envelope"></i>
                    <span>{{ user.email }}</span>
                </div>
                <div class="info-item">
                    <i class="fa-solid fa-phone"></i>
                    <span>{{ user.phone || '-' }}</span>
                </div>
                <div class="info-item">
                    <i class="fa-solid fa-gift"></i>
                    <span>Date of birth - {{ user.dateOfBirth || '-' }}</span>
                </div>
                <div class="info-item">
                    <i class="fa-solid fa-location-dot"></i>
                    <span>From {{ user.country || '-' }}</span>
                </div>
            </div>

            <!-- EDIT FORM -->
            <div *ngIf="editMode" class="address-form edit-profile-form">

                <!-- Header -->
                <div class="header info-header">
                    <h1>MODIFY MY PROFILE</h1>
                    <button type="button" class="cancel-btns" (click)="editMode = false">
                        Cancel <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>

                <!-- Form -->
                <div class="form-container">
                    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">

                        <!-- Title -->
                        <div class="form-groups">
                            <label>Title</label>
                            <div class="select-wrapper">
                                <select formControlName="title">
                                    <option *ngFor="let t of titles" [value]="t">{{ t }}</option>
                                </select>
                            </div>
                        </div>

                        <!-- First & Last Name -->
                        <div class="form-row">
                            <div class="form-groups">
                                <div class="gap-form">
                                    <label>First Name*</label>
                                    <span
                                        style="padding-top: 1.5px; font-weight: 500; font-size: 10px; color: #666;">Your
                                        first name</span>
                                </div>
                                <div class="input-container">
                                    <input type="text" placeholder="Your first name" formControlName="firstName" />
                                </div>
                                <div *ngIf="userForm.get('firstName')?.invalid && userForm.get('firstName')?.touched"
                                    class="error-message">
                                    First name is required
                                </div>
                            </div>

                            <div class="form-groups">
                                <div class="gap-form">
                                    <label>Last Name*</label>
                                    <span
                                        style="padding-top: 1.5px; font-weight: 500; font-size: 10px; color: #666;">Your
                                        last name</span>
                                </div>
                                <div class="input-container">
                                    <input type="text" placeholder="Your last name" formControlName="lastName" />
                                </div>
                                <div *ngIf="userForm.get('lastName')?.invalid && userForm.get('lastName')?.touched"
                                    class="error-message">
                                    Last name is required
                                </div>
                            </div>
                        </div>

                        <!-- Phone & Birth Date -->
                        <div class="form-row">
                            <div class="form-groups phone-group">
                                <label><i class="fas fa-phone phone-icon"></i> Telephone*</label>
                                <div class="phone-input">
                                    <!-- Country Code -->
                                    <div class="country-code-wrapper dropdown-container">
                                        <!-- Phone Code + Number -->
                                        <div class="country-code">
                                            <div style="width: 70px;">
                                                <select formControlName="number" style="width: 70px">
                                                    <option *ngFor="let n of numbers" [value]="n">{{ n }}</option>
                                                </select>
                                            </div>

                                            <input type="number" placeholder="111 222 34 56"
                                                formControlName="phoneNumber" class="mx-2" style="width: 183px;" />
                                        </div>

                                    </div>

                                </div>
                                <div *ngIf="userForm.get('phoneNumber')?.invalid && userForm.get('phoneNumber')?.touched"
                                    class="error-message">
                                    Valid phone number is required
                                </div>
                            </div>

                            <div class="form-groups">
                                <label>Date of Birth*</label>
                                <input type="date" formControlName="dateOfBirth" />
                                <div *ngIf="userForm.get('dateOfBirth')?.invalid && userForm.get('dateOfBirth')?.touched"
                                    class="error-message">
                                    Date of birth is required
                                </div>
                            </div>
                        </div>

                        <!-- Country -->
                        <div class="form-groups">
                            <label>Country*</label>
                            <div class="select-wrapper">
                                <select formControlName="country">
                                    <option value="" disabled>Select your country</option>
                                    <option *ngFor="let c of countryNames" [value]="c">{{ c }}</option>
                                </select>
                            </div>
                            <div *ngIf="userForm.get('country')?.invalid && userForm.get('country')?.touched"
                                class="error-message">
                                Country is required
                            </div>
                        </div>

                        <!-- Save Button -->
                        <div class="save-button-container ">
                            <button type="submit" class="save-btn" [disabled]="userForm.invalid">SAVE YOUR
                                CHANGES</button>
                        </div>


                    </form>
                </div>
            </div>



            <div class="action-links" *ngIf="!editMode">
                <a (click)="editInformation()">> EDIT INFORMATION</a>
                <a (click)="changePassword()">> CHANGE MY PASSWORD</a>
                <a (click)="changeEmail()">> CHANGE EMAIL</a>
            </div>
            <div class="delete-links" *ngIf="!editMode">
                <a class="delete-link" (click)="deleteAccount()"><img src="/image/delete-svgrepo-com.svg" alt="">Delete
                    account</a>
            </div>
        </div>

        <!-- ADDRESS SECTION -->
        <div class="section-title">MY ADDRESS</div>
        <div class="profile-section">
            <div class="subsection-title">YOUR SAVED ADDRESSES</div>
            <div *ngIf="!addressesRegistered" class="empty-address">No address registered yet</div>
            <div *ngIf="addressesRegistered" class="address-list">
                <div class="address-item" *ngFor="let address of savedAddresses">
                    <div>{{ address.name }}</div>
                    <div>{{ address.address }}</div>
                    <div>{{ address.city }}, {{ address.postal_code }}</div>
                    <div>{{ address.country }}</div>
                    <div>{{ address.phone }}</div>
                </div>
            </div>
            <button class="add-address-btn" (click)="openAddress = true"><span class="plus-button">+</span> ADD A NEW
                ADDRESS</button>
        </div>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="profile-column right-column">
        <!-- COMMUNICATION PREFERENCES -->
        <div class="section-title">COMMUNICATION PREFERENCES</div>
        <div class="profile-section">
            <div class="subsection-title">SUBSCRIPTIONS</div>
            <div class="subsection-title-small">COMMUNICATION SUBSCRIPTIONS</div>
            <div class="border-line">
                <div class="checkbox-item">
                    <div class="checkbox-items">
                        <input type="checkbox" id="newsletterMain" [(ngModel)]="subscriptions.newsMain" checked />
                        <label for="newsletterMain">I would like to receive the latest news regarding TAG Heuer's
                            products and services :</label>

                    </div>
                </div>
                <div class="checkbox-item indented">
                    <input type="checkbox" id="tagNewsletter" [(ngModel)]="subscriptions.newsMain" />
                    <label for="tagNewsletter">via TAG Heuer's newsletters</label>
                </div>
            </div>
            <div class="button-padding">
                <div class="saves-btns" style="cursor: pointer;" (click)="savePreferences()">Save</div>
            </div>
        </div>

        <!-- CONFIDENTIALITY PREFERENCES -->
        <div class="section-title">CONFIDENTIALITY PREFERENCES</div>
        <div class="profile-section">
            <div class="subsection-title">NOTIFICATIONS & COOKIES</div>
            <div class="subsection-text">
                <span class="arrow link-action">></span>
                <a (click)="manageCookies()" class="link-action">MANAGE COOKIES</a>
            </div>
        </div>
    </div>
</div>

<!-- ADDRESS MODAL -->
<!-- ADDRESS MODAL -->
<div class="address-modal-overlay" *ngIf="openAddress">
    <div class="address-modal">
        <div class="modal-header">
            <h2>ADD AN ADDRESS</h2>
            <span class="mandatory-note">* Mandatory fields</span>
            <button class="close-btn" (click)="closeAddress()">×</button>
        </div>

        <div class="modal-content">
            <form [formGroup]="addressForm" (ngSubmit)="saveAddress()">
                <div class="form-group">
                    <label for="addressName">Address Name</label>
                    <input type="text" id="addressName" formControlName="addressName"
                        placeholder="Home, Office, etc." />
                </div>

                <div class="form-group">
                    <label for="name">Full Name *</label>
                    <input type="text" id="name" formControlName="name" placeholder="Your full name" required />
                </div>

                <div class="form-group">
                    <label for="address">Address *</label>
                    <input type="text" id="address" formControlName="address" placeholder="Street address or P.O. Box"
                        required />
                </div>

                <div class="form-group">
                    <label for="city">City *</label>
                    <input type="text" id="city" formControlName="city" placeholder="City" required />
                </div>

                <div class="form-group">
                    <label for="region">Region/State *</label>
                    <input type="text" id="region" formControlName="region" placeholder="State/Province/Region"
                        required />
                </div>

                <div class="form-group">
                    <label for="postal_code">Postal Code *</label>
                    <input type="text" id="postal_code" formControlName="postal_code" placeholder="ZIP or Postal Code"
                        required />
                </div>

                <div class="form-group">
                    <label for="country">Country *</label>
                    <select id="country" formControlName="country" required>
                        <option value="" disabled selected>Select a country</option>
                        <option value="PK">Pakistan</option>
                        <option value="IND">India</option>
                        <option value="US">United States</option>
                        <option value="CA">Canada</option>
                        <option value="UK">United Kingdom</option>
                        <option value="FR">France</option>
                        <option value="DE">Germany</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number *</label>
                    <input type="tel" id="phone" formControlName="phone" placeholder="Phone number" required />
                </div>

                <div class="form-actions">
                    <button type="submit" class="save-btn">SAVE</button>
                    <button type="button" class="cancel-btn" (click)="closeAddress()">CANCEL</button>
                </div>
            </form>
        </div>
    </div>
</div>